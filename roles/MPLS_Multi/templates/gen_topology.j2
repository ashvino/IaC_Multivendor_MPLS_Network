# Autogenerated from template
topo:
{% for host in groups['MPLS_Multi']|sort %}
  {{ host }}:
{% for lcnum in hostvars[host]['interfaces']['linecard'] if hostvars[host]['interfaces'] is defined %}
{% for slotnum in hostvars[host]['interfaces']['linecard'][lcnum]['slot'] %}
{% for portnum in hostvars[host]['interfaces']['linecard'][lcnum]['slot'][slotnum]['port'] %}
{% set interface_dict = hostvars[host]['interfaces']['linecard'][lcnum]['slot'][slotnum]['port'][portnum] %}
{% set intflast = (lcnum)|string + "/" + (slotnum)|string + "/" + (portnum)|string if host not in groups['ALU'] else (lcnum+1)|string + "/" + (slotnum+1)|string + "/" + (portnum+1)|string %}
{% set intf = (hostvars[host]['int_prefix'][interface_dict.phy])|string + intflast|string if host not in groups['ALU'] else intflast %}
{% if interface_dict.function is defined and interface_dict.function != 'access' %}
{% if interface_dict.units is defined %}
{% for logical_unit in interface_dict.units %}
    {{ logical_unit.neighbor }}:
      ifname: {{ logical_unit.function }}_{{ logical_unit.neighbor }}
      ifl: {{ intf }}{{ '.' if host not in groups['ALU'] else ':' }}{{ logical_unit.id }}
      inet: {{ logical_unit.inet }}
{% endfor %}
{% else %}
    {{ interface_dict.neighbor }}:
      ifname: {{ interface_dict.function }}_{{ interface_dict.neighbor }}
{% if host in groups['ALU'] %}
      ifl: {{ intf }}
{% else %}
      ifl: {{ intf }}.0
{% endif %}
      inet: {{ interface_dict.inet }}
{% endif %}
{% endif %}
{% endfor %}
{% endfor %}
{% endfor %}
{% endfor %}
